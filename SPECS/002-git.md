# Git Module Specification

## Purpose

The Git Module is responsible for all interactions with the version control system. It provides a high-level API for cloning, fetching, pulling, pushing, and committing notes.

## Version Control Operations

### Adding a Note

- **Purpose**: Adds a note to the version control system.
- **Inputs**:
  - The note object to be added.
- **Outputs**: None.
- **Preconditions**: The note must be saved to disk.
- **Postconditions**: The note is staged for the next commit.
- **Error Cases**:
  - If the note has not been saved to disk, an error is returned.
- **Behavioral Examples**:
  - When a new note is created, it is added to the version control system.

### Adding a Folder

- **Purpose**: Adds a folder to the version control system.
- **Inputs**:
  - The folder object to be added.
- **Outputs**: None.
- **Preconditions**: The folder must be created on disk.
- **Postconditions**: The folder is staged for the next commit.
- **Error Cases**:
  - If the folder has not been created on disk, an error is returned.
- **Behavioral Examples**:
  - When a new folder is created, it is added to the version control system.

### Renaming a Folder

- **Purpose**: Renames a folder in the version control system.
- **Inputs**:
  - The old path of the folder.
  - The new path of the folder.
- **Outputs**: None.
- **Preconditions**: The old path must exist in the repository.
- **Postconditions**: The folder is renamed and the change is staged for the next commit.
- **Error Cases**:
  - If the old path does not exist, an error is returned.
- **Behavioral Examples**:
  - When a folder is renamed, the change is recorded in the version control system.

### Removing Notes

- **Purpose**: Removes a list of notes from the version control system.
- **Inputs**:
  - A list of note objects to be removed.
- **Outputs**: None.
- **Preconditions**: The notes must exist in the repository.
- **Postconditions**: The notes are removed from the repository and the change is staged for the next commit.
- **Error Cases**:
  - If any of the notes do not exist, an error is returned.
- **Behavioral Examples**:
  - When a note is deleted, it is removed from the version control system.

### Fetching Changes

- **Purpose**: Fetches the latest changes from the remote repository.
- **Inputs**: None.
- **Outputs**: None.
- **Preconditions**: The repository must have a configured remote.
- **Postconditions**: The remote tracking branches are updated.
- **Error Cases**:
  - If the remote is not configured, an error is returned.
  - If there is a network error, an error is returned.
- **Behavioral Examples**:
  - A user can manually trigger a fetch to get the latest changes from the remote repository.

### Merging Changes

- **Purpose**: Merges the remote tracking branch into the current local branch.
- **Inputs**: None.
- **Outputs**: None.
- **Preconditions**: The remote tracking branch must be up-to-date.
- **Postconditions**: The remote changes are merged into the local branch.
- **Error Cases**:
  - If there are merge conflicts, an error is returned.
- **Behavioral Examples**:
  - After a fetch, the user can merge the remote changes into their local branch.

### Pushing Changes

- **Purpose**: Pushes the local changes to the remote repository.
- **Inputs**: None.
- **Outputs**: None.
- **Preconditions**: The local branch must be ahead of the remote tracking branch.
- **Postconditions**: The local changes are pushed to the remote repository.
- **Error Cases**:
  - If the local branch is not ahead of the remote, an error is returned.
  - If there is a network error, an error is returned.
- **Behavioral Examples**:
  - A user can push their local changes to the remote repository to share them with others.

## Repository Management

### Adding and Switching Repositories

- **Purpose**: Adds a new repository and switches to it.
- **Inputs**:
  - The path or URL of the repository to add.
- **Outputs**: The ID of the new repository.
- **Preconditions**: None.
- **Postconditions**: A new repository is created and the application is switched to it.
- **Behavioral Examples**:
  - A user can add a new repository to the application and switch to it.

### Setting the Current Repository

- **Purpose**: Switches to the repository with the given ID.
- **Inputs**:
  - The ID of the repository to switch to.
- **Outputs**: None.
- **Preconditions**: The repository with the given ID must exist.
- **Postconditions**: The application is switched to the specified repository.
- **Error Cases**:
  - If the repository with the given ID does not exist, an error is returned.
- **Behavioral Examples**:
  - A user can switch between multiple repositories.

### Deleting the Current Repository

- **Purpose**: Deletes the current repository.
- **Inputs**: None.
- **Outputs**: None.
- **Preconditions**: There must be at least one other repository to switch to.
- **Postconditions**: The current repository is deleted and the application is switched to another repository.
- **Error Cases**:
  - If there are no other repositories to switch to, an error is returned.
- **Behavioral Examples**:
  - A user can delete a repository that they no longer need.

## Non-goals

- **Version Control Server**: This module does not provide a version control server.
- **Advanced Version Control Operations**: This module does not expose advanced version control operations, such as branching and merging.
- **User Interface**: This module does not provide a user interface for managing repositories.
